!function(e){"function"==typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],(function(t){return e(t,window,document)})):"object"==typeof exports?module.exports=function(t,o){return t||(t=window),o&&o.fn.dataTable||(o=require("datatables.net")(t,o).$),o.fn.dataTable.Buttons||require("datatables.net-buttons")(t,o),e(o,t,t.document)}:e(jQuery,window,document)}((function(e,t,o,n){var r,a=e.fn.dataTable;if("undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))r=void 0;else{var i=t.document,s=i.createElementNS("http://www.w3.org/1999/xhtml","a"),l="download"in s,c=t.webkitRequestFileSystem,p=t.requestFileSystem||c||t.mozRequestFileSystem,f=function(e){(t.setImmediate||t.setTimeout)((function(){throw e}),0)},u=0,d=function(e){var o=function(){"string"==typeof e?(t.URL||t.webkitURL||t).revokeObjectURL(e):e.remove()};t.chrome?o():setTimeout(o,500)},m=function(e,t,o){for(var n=(t=[].concat(t)).length;n--;){var r=e["on"+t[n]];if("function"==typeof r)try{r.call(e,o||e)}catch(e){f(e)}}},h=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e},x=function(e,o){e=h(e);var r,a,f,x=this,b=e.type,y=!1,w=function(){m(x,["writestart","progress","write","writeend"])},g=function(){!y&&r||(r=(t.URL||t.webkitURL||t).createObjectURL(e)),a?a.location.href=r:t.open(r,"_blank")===n&&"undefined"!=typeof safari&&(t.location.href=r),x.readyState=x.DONE,w(),d(r)},v=function(e){return function(){if(x.readyState!==x.DONE)return e.apply(this,arguments)}},k={create:!0,exclusive:!1};x.readyState=x.INIT,o||(o="download"),l?(r=(t.URL||t.webkitURL||t).createObjectURL(e),s.href=r,s.download=o,(b=i.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,t,0,0,0,0,0,!1,!1,!1,!1,0,null),s.dispatchEvent(b),x.readyState=x.DONE,w(),d(r)):(t.chrome&&b&&"application/octet-stream"!==b&&(f=e.slice||e.webkitSlice,e=f.call(e,0,e.size,"application/octet-stream"),y=!0),c&&"download"!==o&&(o+=".download"),("application/octet-stream"===b||c)&&(a=t),p?(u+=e.size,p(t.TEMPORARY,u,v((function(t){t.root.getDirectory("saved",k,v((function(t){var n=function(){t.getFile(o,k,v((function(t){t.createWriter(v((function(o){o.onwriteend=function(e){a.location.href=t.toURL(),x.readyState=x.DONE,m(x,"writeend",e),d(t)},o.onerror=function(){var e=o.error;e.code!==e.ABORT_ERR&&g()},["writestart","progress","write","abort"].forEach((function(e){o["on"+e]=x["on"+e]})),o.write(e),x.abort=function(){o.abort(),x.readyState=x.DONE},x.readyState=x.WRITING})),g)})),g)};t.getFile(o,{create:!1},v((function(e){e.remove(),n()})),v((function(e){e.code===e.NOT_FOUND_ERR?n():g()})))})),g)})),g)):g())},b=x.prototype;"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?r=function(e,t){return navigator.msSaveOrOpenBlob(h(e),t)}:(b.abort=function(){this.readyState=this.DONE,m(this,"abort")},b.readyState=b.INIT=0,b.WRITING=1,b.DONE=2,b.error=b.onwritestart=b.onprogress=b.onwrite=b.onabort=b.onerror=b.onwriteend=null,r=function(e,t){return new x(e,t)})}var y=function(t,o){var r="*"===t.filename&&"*"!==t.title&&t.title!==n?t.title:t.filename;return-1!==r.indexOf("*")&&(r=r.replace("*",e("title").text())),r=r.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""),o===n||!0===o?r+t.extension:r},w=function(t){return-1!==(t=t.title).indexOf("*")?t.replace("*",e("title").text()):t},g=function(e){return e.newline?e.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"},v=function(e,t){for(var o=g(t),r=e.buttons.exportData(t.exportOptions),a=t.fieldBoundary,i=t.fieldSeparator,s=RegExp(a,"g"),l=t.escapeChar!==n?t.escapeChar:"\\",c=function(e){for(var t="",o=0,n=e.length;o<n;o++)0<o&&(t+=i),t+=a?a+(""+e[o]).replace(s,l+a)+a:e[o];return t},p=t.header?c(r.header)+o:"",f=t.footer?o+c(r.footer):"",u=[],d=0,m=r.body.length;d<m;d++)u.push(c(r.body[d]));return{str:p+u.join(o)+f,rows:u.length}},k=function(){return-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Opera")},S={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\t<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\t<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/></Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">\t<Default Extension="xml" ContentType="application/xml"/>\t<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>\t<Default Extension="jpeg" ContentType="image/jpeg"/>\t<Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>\t<Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/></Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">\t<fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/>\t<workbookPr showInkAnnotation="0" autoCompressPictures="0"/>\t<bookViews>\t\t<workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/>\t</bookViews>\t<sheets>\t\t<sheet name="Sheet1" sheetId="1" r:id="rId1"/>\t</sheets></workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">\t<sheetData>\t\t__DATA__\t</sheetData></worksheet>'};return a.ext.buttons.copyHtml5={className:"buttons-copy buttons-html5",text:function(e){return e.i18n("buttons.copy","Copy")},action:function(t,n,r,a){if(a=(t=v(n,a)).str,r=e("<div/>").css({height:1,width:1,overflow:"hidden",position:"fixed",top:0,left:0}),a=e("<textarea readonly/>").val(a).appendTo(r),o.queryCommandSupported("copy")){r.appendTo("body"),a[0].focus(),a[0].select();try{return o.execCommand("copy"),r.remove(),void n.buttons.info(n.i18n("buttons.copyTitle","Copy to clipboard"),n.i18n("buttons.copySuccess",{1:"Copied one row to clipboard",_:"Copied %d rows to clipboard"},t.rows),2e3)}catch(e){}}t=e("<span>"+n.i18n("buttons.copyKeys","Press <i>ctrl</i> or <i>âŒ˜</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.")+"</span>").append(r),n.buttons.info(n.i18n("buttons.copyTitle","Copy to clipboard"),t,0),a[0].focus(),a[0].select();var i=e(t).closest(".dt-button-info"),s=function(){i.off("click.buttons-copy"),e(o).off(".buttons-copy"),n.buttons.info(!1)};i.on("click.buttons-copy",s),e(o).on("keydown.buttons-copy",(function(e){27===e.keyCode&&s()})).on("copy.buttons-copy cut.buttons-copy",(function(){s()}))},exportOptions:{},fieldSeparator:"\t",fieldBoundary:"",header:!0,footer:!1},a.ext.buttons.csvHtml5={className:"buttons-csv buttons-html5",available:function(){return t.FileReader!==n&&t.Blob},text:function(e){return e.i18n("buttons.csv","CSV")},action:function(e,t,n,a){g(a),e=v(t,a).str,!1!==(t=a.charset)?(t||(t=o.characterSet||o.charset),t&&(t=";charset="+t)):t="",r(new Blob([e],{type:"text/csv"+t}),y(a))},filename:"*",extension:".csv",exportOptions:{},fieldSeparator:",",fieldBoundary:'"',escapeChar:'"',charset:null,header:!0,footer:!1},a.ext.buttons.excelHtml5={className:"buttons-excel buttons-html5",available:function(){return t.FileReader!==n&&t.JSZip!==n&&!k()},text:function(e){return e.i18n("buttons.excel","Excel")},action:function(e,o,a,i){e="",o=o.buttons.exportData(i.exportOptions),a=function(e){for(var t=[],o=0,r=e.length;o<r;o++)null!==e[o]&&e[o]!==n||(e[o]=""),t.push("number"==typeof e[o]||e[o].match&&e[o].match(/^-?[0-9\.]+$/)&&"0"!==e[o].charAt(0)?'<c t="n"><v>'+e[o]+"</v></c>":'<c t="inlineStr"><is><t>'+(e[o].replace?e[o].replace(/&(?!amp;)/g,"&amp;").replace(/[\x00-\x1F\x7F-\x9F]/g,""):e[o])+"</t></is></c>");return"<row>"+t.join("")+"</row>"},i.header&&(e+=a(o.header));for(var s=0,l=o.body.length;s<l;s++)e+=a(o.body[s]);i.footer&&(e+=a(o.footer));a=(o=new t.JSZip).folder("_rels"),s=o.folder("xl"),l=o.folder("xl/_rels");var c=o.folder("xl/worksheets");o.file("[Content_Types].xml",S["[Content_Types].xml"]),a.file(".rels",S["_rels/.rels"]),s.file("workbook.xml",S["xl/workbook.xml"]),l.file("workbook.xml.rels",S["xl/_rels/workbook.xml.rels"]),c.file("sheet1.xml",S["xl/worksheets/sheet1.xml"].replace("__DATA__",e)),r(o.generate({type:"blob"}),y(i))},filename:"*",extension:".xlsx",exportOptions:{},header:!0,footer:!1},a.ext.buttons.pdfHtml5={className:"buttons-pdf buttons-html5",available:function(){return t.FileReader!==n&&t.pdfMake},text:function(e){return e.i18n("buttons.pdf","PDF")},action:function(o,n,a,i){g(i),o=n.buttons.exportData(i.exportOptions),n=[],i.header&&n.push(e.map(o.header,(function(e){return{text:"string"==typeof e?e:e+"",style:"tableHeader"}})));var s=0;for(a=o.body.length;s<a;s++)n.push(e.map(o.body[s],(function(e){return{text:"string"==typeof e?e:e+"",style:s%2?"tableBodyEven":"tableBodyOdd"}})));i.footer&&n.push(e.map(o.footer,(function(e){return{text:"string"==typeof e?e:e+"",style:"tableFooter"}}))),o={pageSize:i.pageSize,pageOrientation:i.orientation,content:[{table:{headerRows:1,body:n},layout:"noBorders"}],styles:{tableHeader:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154",alignment:"center"},tableBodyEven:{},tableBodyOdd:{fillColor:"#f3f3f3"},tableFooter:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154"},title:{alignment:"center",fontSize:15},message:{}},defaultStyle:{fontSize:10}},i.message&&o.content.unshift({text:i.message,style:"message",margin:[0,0,0,12]}),i.title&&o.content.unshift({text:w(i),style:"title",margin:[0,0,0,12]}),i.customize&&i.customize(o),o=t.pdfMake.createPdf(o),"open"!==i.download||k()?o.getBuffer((function(e){e=new Blob([e],{type:"application/pdf"}),r(e,y(i))})):o.open()},title:"*",filename:"*",extension:".pdf",exportOptions:{},orientation:"portrait",pageSize:"A4",header:!0,footer:!1,message:null,customize:null,download:"download"},a.Buttons}));
